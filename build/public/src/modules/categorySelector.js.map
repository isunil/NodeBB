{"version":3,"sources":["public/src/modules/categorySelector.js"],"names":["define","Benchpress","translator","categorySearch","categorySelector","init","el","callback","selector","selectedCategory","on","categoryEl","$","this","hasClass","selectCategory","attr","cid","find","name","length","html","translateHtml","getSelectedCategory","getSelectedCid","modal","categories","ajaxify","data","allCategories","parse","translate","bootbox","dialog","title","message","buttons","save","label","className","submit","ev","preventDefault"],"mappings":"AAAA,aAEAA,OAAO,oBAAqB,aAAc,aAAc,kBAAmB,SAAUC,EAAYC,EAAYC,GAC5G,IAAIC,KAEJA,EAAiBC,KAAO,SAAUC,EAAIC,GACrCA,EAAWA,GAAY,aACvB,IAAIC,GACHF,GAAIA,EACJG,iBAAkB,MAGnBH,EAAGI,GAAG,QAAS,aAAc,WAC5B,IAAIC,EAAaC,EAAEC,MACnB,GAAIF,EAAWG,SAAS,YAAa,CACpC,OAAO,MAERN,EAASO,eAAeJ,EAAWK,KAAK,aACxCT,EAASC,EAASC,oBAGnBN,EAAeE,KAAKC,GAEpBE,EAASO,eAAiB,SAAUE,GACnC,IAAIN,EAAaH,EAASF,GAAGY,KAAK,cAAgBD,EAAM,MACxDT,EAASC,kBACRQ,IAAKA,EACLE,KAAMR,EAAWK,KAAK,cAGvB,GAAIL,EAAWS,OAAQ,CACtBZ,EAASF,GAAGY,KAAK,4CAA4CG,KAAKV,EAAWO,KAAK,iCAAiCG,YAC7G,CACNb,EAASF,GAAGY,KAAK,4CAA4CI,cAAc,4CAG7Ed,EAASe,oBAAsB,WAC9B,OAAOf,EAASC,kBAEjBD,EAASgB,eAAiB,WACzB,OAAOhB,EAASC,iBAAmBD,EAASC,iBAAiBQ,IAAM,GAEpE,OAAOT,GAGRJ,EAAiBqB,MAAQ,SAAUC,EAAYnB,GAC9C,UAAWmB,IAAe,WAAY,CACrCnB,EAAWmB,EACXA,EAAaC,QAAQC,KAAKC,cAE3B5B,EAAW6B,MAAM,6CAChBJ,WAAYA,GACV,SAAUL,GACZnB,EAAW6B,UAAUV,EAAM,SAAUA,GACpC,IAAII,EAAQO,QAAQC,QACnBC,MAAO,uCACPC,QAASd,EACTe,SACCC,MACCC,MAAO,oBACPC,UAAW,cACXhC,SAAUiC,MAIb,IAAIhC,EAAWJ,EAAiBC,KAAKoB,EAAMP,KAAK,oCAChD,SAASsB,EAAOC,GACfA,EAAGC,iBACH,GAAIlC,EAASC,iBAAkB,CAC9BF,EAASC,EAASC,iBAAiBQ,KACnCQ,EAAMA,MAAM,QAEb,OAAO,MAGRA,EAAMP,KAAK,QAAQR,GAAG,SAAU8B,QAKnC,OAAOpC","file":"public/src/modules/categorySelector.js","sourcesContent":["'use strict';\r\n\r\ndefine('categorySelector', ['benchpress', 'translator', 'categorySearch'], function (Benchpress, translator, categorySearch) {\r\n\tvar categorySelector = {};\r\n\r\n\tcategorySelector.init = function (el, callback) {\r\n\t\tcallback = callback || function () {};\r\n\t\tvar selector = {\r\n\t\t\tel: el,\r\n\t\t\tselectedCategory: null,\r\n\t\t};\r\n\r\n\t\tel.on('click', '[data-cid]', function () {\r\n\t\t\tvar categoryEl = $(this);\r\n\t\t\tif (categoryEl.hasClass('disabled')) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tselector.selectCategory(categoryEl.attr('data-cid'));\r\n\t\t\tcallback(selector.selectedCategory);\r\n\t\t});\r\n\r\n\t\tcategorySearch.init(el);\r\n\r\n\t\tselector.selectCategory = function (cid) {\r\n\t\t\tvar categoryEl = selector.el.find('[data-cid=\"' + cid + '\"]');\r\n\t\t\tselector.selectedCategory = {\r\n\t\t\t\tcid: cid,\r\n\t\t\t\tname: categoryEl.attr('data-name'),\r\n\t\t\t};\r\n\r\n\t\t\tif (categoryEl.length) {\r\n\t\t\t\tselector.el.find('[component=\"category-selector-selected\"]').html(categoryEl.find('[component=\"category-markup\"]').html());\r\n\t\t\t} else {\r\n\t\t\t\tselector.el.find('[component=\"category-selector-selected\"]').translateHtml('[[topic:thread_tools.select_category]]');\r\n\t\t\t}\r\n\t\t};\r\n\t\tselector.getSelectedCategory = function () {\r\n\t\t\treturn selector.selectedCategory;\r\n\t\t};\r\n\t\tselector.getSelectedCid = function () {\r\n\t\t\treturn selector.selectedCategory ? selector.selectedCategory.cid : 0;\r\n\t\t};\r\n\t\treturn selector;\r\n\t};\r\n\r\n\tcategorySelector.modal = function (categories, callback) {\r\n\t\tif (typeof categories === 'function') {\r\n\t\t\tcallback = categories;\r\n\t\t\tcategories = ajaxify.data.allCategories;\r\n\t\t}\r\n\t\tBenchpress.parse('admin/partials/categories/select-category', {\r\n\t\t\tcategories: categories,\r\n\t\t}, function (html) {\r\n\t\t\ttranslator.translate(html, function (html) {\r\n\t\t\t\tvar modal = bootbox.dialog({\r\n\t\t\t\t\ttitle: '[[modules:composer.select_category]]',\r\n\t\t\t\t\tmessage: html,\r\n\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\tsave: {\r\n\t\t\t\t\t\t\tlabel: '[[global:select]]',\r\n\t\t\t\t\t\t\tclassName: 'btn-primary',\r\n\t\t\t\t\t\t\tcallback: submit,\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t},\r\n\t\t\t\t});\r\n\t\t\t\tvar selector = categorySelector.init(modal.find('[component=\"category-selector\"]'));\r\n\t\t\t\tfunction submit(ev) {\r\n\t\t\t\t\tev.preventDefault();\r\n\t\t\t\t\tif (selector.selectedCategory) {\r\n\t\t\t\t\t\tcallback(selector.selectedCategory.cid);\r\n\t\t\t\t\t\tmodal.modal('hide');\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tmodal.find('form').on('submit', submit);\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\treturn categorySelector;\r\n});\r\n"]}