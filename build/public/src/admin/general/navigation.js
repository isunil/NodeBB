"use strict";define("admin/general/navigation",["translator","iconSelect","benchpress","jqueryui"],function(a,e,n){var i={};var t;i.init=function(){t=ajaxify.data.available;$("#enabled .unescape").each(function(){$(this).val(a.unescape($(this).val()))});a.translate($("#available").html(),function(e){$("#available").html(a.unescape(e)).find("li .drag-item").draggable({connectToSortable:"#active-navigation",helper:"clone",distance:10,stop:l})});$("#active-navigation").sortable().droppable({accept:$("#available li .drag-item")});$("#enabled").on("click",".iconPicker",function(){var a=$(this).find("i");e.init(a,function(e){var n=e.attr("value");var i=a.parents("[data-index]").attr("data-index");$('#active-navigation [data-index="'+i+'"] i').attr("class","fa fa-fw "+n);a.siblings('[name="iconClass"]').val(n);a.siblings(".change-icon-link").toggleClass("hidden",!!n)})});$("#active-navigation").on("click","li",r);$("#enabled").on("click",".delete",c).on("click",".toggle",o);$("#save").on("click",s)};function r(){var a=$(this).attr("data-index");$("#active-navigation li").removeClass("active");$(this).addClass("active");var e=$("#enabled").children('[data-index="'+a+'"]');$("#enabled li").addClass("hidden");if(e.length){e.removeClass("hidden")}return false}function l(e,i){var r=i.helper.attr("data-id");var l=$('#active-navigation [data-id="'+r+'"]');var s=r==="custom"?{iconClass:"fa-navicon",groups:t[0].groups}:t[r];s.enabled=false;s.index=(parseInt($("#enabled").children().last().attr("data-index"),10)||0)+1;s.title=a.escape(s.title);s.text=a.escape(s.text);s.groups=ajaxify.data.groups;n.parse("admin/general/navigation","navigation",{navigation:[s]},function(e){a.translate(e,function(e){e=$(a.unescape(e));l.after(e);l.remove()})});n.parse("admin/general/navigation","enabled",{enabled:[s]},function(e){a.translate(e,function(e){e=$(a.unescape(e));$("#enabled").append(e);componentHandler.upgradeDom()})})}function s(){var e=[];var n=[];$("#active-navigation li").each(function(){n.push($(this).attr("data-index"))});n.forEach(function(n){var i=$("#enabled").children('[data-index="'+n+'"]');var t=i.find("form").serializeArray();var r={};var l={};t.forEach(function(e){if(e.name.slice(0,9)==="property:"&&e.value==="on"){l[e.name.slice(9)]=true}else if(r[e.name]){if(!Array.isArray(r[e.name])){r[e.name]=[r[e.name]]}r[e.name].push(e.value)}else{r[e.name]=a.escape(e.value)}});r.properties={};for(var s in l){if(l.hasOwnProperty(s)){r.properties[s]=l[s]}}e.push(r)});socket.emit("admin.navigation.save",e,function(a){if(a){app.alertError(a.message)}else{app.alertSuccess("Successfully saved navigation")}})}function c(){var a=$(this).parents("[data-index]").attr("data-index");$('#active-navigation [data-index="'+a+'"]').remove();$('#enabled [data-index="'+a+'"]').remove();return false}function o(){var e=$(this);var n=e.hasClass("btn-success");a.translate(n?"[[admin/general/navigation:btn.disable]]":"[[admin/general/navigation:btn.enable]]",function(a){e.toggleClass("btn-warning").toggleClass("btn-success").html(a);e.parents("li").find('[name="enabled"]').val(n?"on":"")});return false}return i});
//# sourceMappingURL=navigation.js.map