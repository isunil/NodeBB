"use strict";define("forum/topic/merge",function(){var t={};var e;var n;var o={};t.init=function(){if(e){return}app.parseAndTranslate("partials/merge_topics_modal",{},function(t){e=t;$("body").append(e);n=e.find("#merge_topics_confirm");e.find(".close,#merge_topics_cancel").on("click",s);$("#content").on("click",'[component="category"] [component="category/topic"] a',i);c();n.on("click",function(){r(n)})})};function i(t){var e=$(this).parents('[component="category/topic"]').attr("data-tid");socket.emit("topics.getTopic",e,function(t,n){if(t){return app.alertError(t)}var i=n?n.title:"No title";if(o[e]){delete o[e]}else{o[e]=i}a();c()});t.preventDefault();t.stopPropagation();return false}function r(t){t.attr("disabled",true);var e=Object.keys(o);socket.emit("topics.merge",e,function(n){t.removeAttr("disabled");if(n){return app.alertError(n.message)}ajaxify.go("/topic/"+e[0]);s()})}function c(){var t=Object.keys(o);t.sort(function(t,e){return t-e});var n=t.map(function(t){return{tid:t,title:o[t]}});if(t.length){app.parseAndTranslate("partials/merge_topics_modal","topics",{topics:n},function(t){e.find(".topics-section").html(t)})}else{e.find(".topics-section").translateHtml("[[error:no-topics-selected]]")}}function a(){if(Object.keys(o).length){n.removeAttr("disabled")}else{n.attr("disabled",true)}}function s(){if(e){e.remove();e=null}o={};$("#content").off("click",'[component="category"] [component="category/topic"] a',i)}return t});
//# sourceMappingURL=merge.js.map