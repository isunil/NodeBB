"use strict";define("forum/topic/diffs",["forum/topic/images","benchpress","translator"],function(t,e,n){var s={};s.open=function(t){if(!config.enablePostHistory){return}var i={year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"numeric"};socket.emit("posts.getDiffs",{pid:t},function(o,r){if(o){return app.alertError(o.message)}e.parse("partials/modals/post_history",{diffs:r.map(function(t){t=parseInt(t,10);return{timestamp:t,pretty:new Date(t).toLocaleString(config.userLang.replace("_","-"),i)}}),numDiffs:r.length},function(e){n.translate(e,function(e){var n=bootbox.dialog({title:"[[topic:diffs.title]]",message:e,size:"large"});if(!r.length){return}var i=n.find("select");var o=n.find("ul.posts-list");i.on("change",function(){s.load(t,this.value,o)});n.on("shown.bs.modal",function(){s.load(t,i.val(),o)})})})})};s.load=function(t,e,n){if(!config.enablePostHistory){return}socket.emit("posts.showPostAt",{pid:t,since:e},function(t,e){if(t){return app.alertError(t.message)}e.deleted=!!parseInt(e.deleted,10);app.parseAndTranslate("partials/posts_list","posts",{posts:[e]},function(t){n.empty().append(t)})})};return s});
//# sourceMappingURL=diffs.js.map