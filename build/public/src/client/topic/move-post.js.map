{"version":3,"sources":["public/src/client/topic/move-post.js"],"names":["define","components","postSelect","MovePost","moveModal","moveCommit","init","postEl","app","parseAndTranslate","html","find","$","append","on","closeMoveModal","checkMoveButtonEnable","onPostToggled","showPostsSelected","togglePostSelection","attr","movePosts","pids","length","translateHtml","val","removeAttr","tid","socket","emit","err","alertError","message","forEach","pid","get","fadeOut","this","remove","disable"],"mappings":"AAAA,aAGAA,OAAO,yBAA0B,aAAc,cAAe,SAAUC,EAAYC,GACnF,IAAIC,KAEJ,IAAIC,EACJ,IAAIC,EAEJF,EAASG,KAAO,SAAUC,GACzB,GAAIH,EAAW,CACd,OAEDI,IAAIC,kBAAkB,8BAAgC,SAAUC,GAC/DN,EAAYM,EAEZL,EAAaD,EAAUO,KAAK,uBAE5BC,EAAE,QAAQC,OAAOT,GAEjBA,EAAUO,KAAK,6BAA6BG,GAAG,QAASC,GACxDX,EAAUO,KAAK,YAAYG,GAAG,QAASE,GACvCd,EAAWI,KAAKW,GAChBC,IAEA,GAAIX,EAAQ,CACXL,EAAWiB,oBAAoBZ,EAAQA,EAAOa,KAAK,aAGpDf,EAAWS,GAAG,QAAS,WACtBO,SAKH,SAASH,IACR,GAAIhB,EAAWoB,KAAKC,OAAQ,CAC3BnB,EAAUO,KAAK,SAASa,cAAc,2BAA6BtB,EAAWoB,KAAKC,OAAS,UACtF,CACNnB,EAAUO,KAAK,SAASa,cAAc,2BAIxC,SAASR,IACR,GAAIZ,EAAUO,KAAK,YAAYc,MAAMF,QAAUrB,EAAWoB,KAAKC,OAAQ,CACtElB,EAAWqB,WAAW,gBAChB,CACNrB,EAAWe,KAAK,WAAY,OAI9B,SAASH,IACRD,IACAE,IAGD,SAASG,IACR,IAAIM,EAAMvB,EAAUO,KAAK,YAAYc,MACrCG,OAAOC,KAAK,mBAAqBP,KAAMpB,EAAWoB,KAAMK,IAAKA,GAAO,SAAUG,GAC7E,GAAIA,EAAK,CACR,OAAOtB,IAAIuB,WAAWD,EAAIE,SAE3B9B,EAAWoB,KAAKW,QAAQ,SAAUC,GACjCjC,EAAWkC,IAAI,OAAQ,MAAOD,GAAKE,QAAQ,IAAK,WAC/CxB,EAAEyB,MAAMC,aAIVvB,MAIF,SAASA,IACR,GAAIX,EAAW,CACdA,EAAUkC,SACVlC,EAAY,KACZF,EAAWqC,WAKb,OAAOpC","file":"public/src/client/topic/move-post.js","sourcesContent":["'use strict';\r\n\r\n\r\ndefine('forum/topic/move-post', ['components', 'postSelect'], function (components, postSelect) {\r\n\tvar MovePost = {};\r\n\r\n\tvar moveModal;\r\n\tvar moveCommit;\r\n\r\n\tMovePost.init = function (postEl) {\r\n\t\tif (moveModal) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tapp.parseAndTranslate('partials/move_post_modal', {}, function (html) {\r\n\t\t\tmoveModal = html;\r\n\r\n\t\t\tmoveCommit = moveModal.find('#move_posts_confirm');\r\n\r\n\t\t\t$('body').append(moveModal);\r\n\r\n\t\t\tmoveModal.find('.close,#move_posts_cancel').on('click', closeMoveModal);\r\n\t\t\tmoveModal.find('#topicId').on('keyup', checkMoveButtonEnable);\r\n\t\t\tpostSelect.init(onPostToggled);\r\n\t\t\tshowPostsSelected();\r\n\r\n\t\t\tif (postEl) {\r\n\t\t\t\tpostSelect.togglePostSelection(postEl, postEl.attr('data-pid'));\r\n\t\t\t}\r\n\r\n\t\t\tmoveCommit.on('click', function () {\r\n\t\t\t\tmovePosts();\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\tfunction showPostsSelected() {\r\n\t\tif (postSelect.pids.length) {\r\n\t\t\tmoveModal.find('#pids').translateHtml('[[topic:fork_pid_count, ' + postSelect.pids.length + ']]');\r\n\t\t} else {\r\n\t\t\tmoveModal.find('#pids').translateHtml('[[topic:fork_no_pids]]');\r\n\t\t}\r\n\t}\r\n\r\n\tfunction checkMoveButtonEnable() {\r\n\t\tif (moveModal.find('#topicId').val().length && postSelect.pids.length) {\r\n\t\t\tmoveCommit.removeAttr('disabled');\r\n\t\t} else {\r\n\t\t\tmoveCommit.attr('disabled', true);\r\n\t\t}\r\n\t}\r\n\r\n\tfunction onPostToggled() {\r\n\t\tcheckMoveButtonEnable();\r\n\t\tshowPostsSelected();\r\n\t}\r\n\r\n\tfunction movePosts() {\r\n\t\tvar tid = moveModal.find('#topicId').val();\r\n\t\tsocket.emit('posts.movePosts', { pids: postSelect.pids, tid: tid }, function (err) {\r\n\t\t\tif (err) {\r\n\t\t\t\treturn app.alertError(err.message);\r\n\t\t\t}\r\n\t\t\tpostSelect.pids.forEach(function (pid) {\r\n\t\t\t\tcomponents.get('post', 'pid', pid).fadeOut(500, function () {\r\n\t\t\t\t\t$(this).remove();\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\tcloseMoveModal();\r\n\t\t});\r\n\t}\r\n\r\n\tfunction closeMoveModal() {\r\n\t\tif (moveModal) {\r\n\t\t\tmoveModal.remove();\r\n\t\t\tmoveModal = null;\r\n\t\t\tpostSelect.disable();\r\n\t\t}\r\n\t}\r\n\r\n\r\n\treturn MovePost;\r\n});\r\n"]}